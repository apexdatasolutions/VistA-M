YSMTI0 ;ALB.ASF,HIOFO/FT - MUTLIPLE PSYCH TESTS FULL PROFILES ;10/23/13 2:11pm
 ;;5.01;MENTAL HEALTH;**53,108**;Dec 30, 1994;Build 17
 ;Reference to VADPT APIs supported by DBIA #10061
 ;Reference to %ZTLOAD APIs supported by DBIA #10063
 ;Reference to ^%ZIS supported by IA #10086
 ;Reference to %ZISC supported by IA #10089
 ;Reference to ^XLFDT APIs supported by DBIA #10103
 K IOP N POP S %ZIS="Q" D ^%ZIS Q:POP
 I $D(IO("Q")) K IO("Q") S ZTRTN="ENTASK^YSMTI0",ZTDESC="YSMTI0" S ZTSAVE("YS*")="" D ^%ZTLOAD W !,$S($D(ZTSK):"QUEUED",1:"Not queued"),$C(7)
 U IO D DATES,TOP,LP,HOME^%ZIS D ^%ZISC U IO
 Q
ENTASK ;taskman entry
 S:$D(ZTQUEUED) ZTREQ="@"
 D ENFRNT^YSMTI,TOP,LP Q
TOP ;
 S YSLN="",$P(YSLN,"_",79)=""
 W:$Y>0 @IOF,!?10,"**** M U L T I P L E   T E S T   A D M I N I S T R A T I O N S ***"
 W !,VADM(1),?40,"SSN: ","xxx-xx-"_$E($P(VADM(2),U,2),8,11),"  ",$P(VADM(5),U,2),?60,"  DOB: ",$P(VADM(3),U,2)
 S X=$P(^YTT(601,YSTEST,"P"),U) W !?(72-$L(X)/2),X
 W !,YSLN
 W !,"Scales",?15,"Administrations",!,YSLN,!?4
 S Y=0 F I=1:1:8 S Y=$O(YSDATES(Y)) Q:Y'>0  W $J($$FMTE^XLFDT(9999999-Y,"5D"),10)
 Q
DATES ;
 S YSSNUMB=$P(^YTT(601,YSTEST,0),U),YSSNUMB=$S(YSSNUMB?1"MC".E:25,1:13)
 K YSDATES S YSDATES=0 F  S YSDATES=$O(^TMP("YSMTI",$J,YSDFN,YSTEST,1,YSDATES)) Q:YSDATES'>0  S YSDATES(9999999-YSDATES)=""
 Q
LP ;loop thru TMP
 F YSCALEN=1:1:YSSNUMB W !,$J($P($P(^YTT(601,YSTEST,"S",YSCALEN,0),U,2)," "),5)," "  D LP1
 Q
LP1 S YSDATES=0 F  S YSDATES=$O(YSDATES(YSDATES)) Q:YSDATES'>0  S YSED=9999999-YSDATES D LP2
 Q
LP2 S Y=^TMP("YSMTI",$J,YSDFN,YSTEST,YSCALEN,YSED)
 S S=$P(Y,U,2) W $J(S,6),?$X+3
 Q
