PSOERXX5 ;ALB/BWF - eRx xml utilities ; 8/3/2016 5:14pm
 ;;7.0;OUTPATIENT PHARMACY;**467**;DEC 1997;Build 153
 ;
 Q
STRUCSIG(GBL,IENS) ;
 N SSPN,MSM,SV,FMTV,SFTSI,SFT,DCI,DDM,DDMCQ,DDMC,DDMMT,DDMMCQ,DDMMC
 N DQ,DFT,DFCQ,DFC,DRM,DBMV,DBUM,DBUMCQ,DBUC,BMQ,BMV,CDM,CDUMT,CDUMCQ,CDUMC,DBRM
 N VN,VNCQ,VUMT,VUMCQ,VUMC,MVM,RAT,RACQ,RAC,MRAM,SAT,SACQ,SAC,MATM,RM,RUMT
 N RUMCQ,RUMC,TPBT,TPBCQ,TPBC,FNV,FUT,FUCQ,FUC,VFM,INV,IUT,IUCQ,IUC,OR,DNV,DT,DTCQ
 N DTC,MDRNV,MDRUT,MDRCQ,MDRUC,MDRVN,MDRVUT,MDRVUCQ,MDRVUC,MDRVDM,IPT,IPCQ,IPC,IT
 N F,ITCQ,ITC,IVT,IVU,IVUMT,IVUMCQ,IVUMC,IVM,STOPI,PSDAT,ATC,ATCQ,ATT,TMATM,VIM,VNC,VQ
 S F=52.4911
 D GETS^DIQ(F,IENS,"**","IE","PSDAT")
 S SSPN=$G(PSDAT(F,IENS,.01,"E"))
 S MSM=$G(PSDAT(F,IENS,.02,"I"))
 S SV=$G(PSDAT(F,IENS,.03,"E"))
 S FMTV=$G(PSDAT(F,IENS,.04,"E"))
 S SFTSI=$G(PSDAT(F,IENS,.05,"E"))
 S SFT=$G(PSDAT(F,IENS,1,"E"))
 S DCI=$G(PSDAT(F,IENS,2.1,"E"))
 S DDM=$G(PSDAT(F,IENS,2.2,"E"))
 S DDMCQ=$G(PSDAT(F,IENS,2.3,"I"))
 S DDMC=$G(PSDAT(F,IENS,2.4,"E"))
 S DDMMT=$G(PSDAT(F,IENS,2.5,"E"))
 S DDMMCQ=$G(PSDAT(F,IENS,2.7,"I"))
 S DDMMC=$G(PSDAT(F,IENS,2.6,"E"))
 S DQ=$G(PSDAT(F,IENS,3.1,"E"))
 S DFT=$$SYMENC^MXMLUTL($G(PSDAT(F,IENS,3.2,"E")))
 S DFCQ=$G(PSDAT(F,IENS,3.4,"I"))
 S DFC=$G(PSDAT(F,IENS,3.3,"E"))
 S DRM=$G(PSDAT(F,IENS,3.5,"I"))
 S DBMV=$G(PSDAT(F,IENS,4.1,"E"))
 S DBUM=$G(PSDAT(F,IENS,4.2,"E"))
 S DBUMCQ=$G(PSDAT(F,IENS,4.4,"I"))
 S DBUC=$G(PSDAT(F,IENS,4.3,"E"))
 S BMQ=$G(PSDAT(F,IENS,4.5,"I"))
 S BMV=$G(PSDAT(F,IENS,4.6,"E"))
 S CDM=$G(PSDAT(F,IENS,4.7,"E"))
 S CDUMT=$$SYMENC^MXMLUTL($G(PSDAT(F,IENS,4.8,"E")))
 S CDUMCQ=$G(PSDAT(F,IENS,4.11,"I"))
 S CDUMC=$G(PSDAT(F,IENS,4.9,"E"))
 S DBRM=$G(PSDAT(F,IENS,4.12,"I"))
 S VN=$G(PSDAT(F,IENS,5.1,"E"))
 S VNC=$G(PSDAT(F,IENS,5.2,"E"))
 S VNCQ=$G(PSDAT(F,IENS,5.3,"I"))
 S VQ=$G(PSDAT(F,IENS,5.4,"E"))
 S VUMT=$$SYMENC^MXMLUTL($G(PSDAT(F,IENS,5.5,"E")))
 S VUMCQ=$G(PSDAT(F,IENS,5.7,"I"))
 S VUMC=$G(PSDAT(F,IENS,5.6,"E"))
 S MVM=$G(PSDAT(F,IENS,5.8,"I"))
 S RAT=$G(PSDAT(F,IENS,6.1,"E"))
 S RACQ=$G(PSDAT(F,IENS,6.3,"I"))
 S RAC=$G(PSDAT(F,IENS,6.2,"E"))
 S MRAM=$G(PSDAT(F,IENS,6.4,"I"))
 S SAT=$G(PSDAT(F,IENS,6.5,"E"))
 S SACQ=$G(PSDAT(F,IENS,6.7,"I"))
 S SAC=$G(PSDAT(F,IENS,6.7,"I"))
 S MATM=$G(PSDAT(F,IENS,6.8,"I"))
 S ATT=$G(PSDAT(F,IENS,7.1,"E"))
 S ATCQ=$G(PSDAT(F,IENS,7.3,"I"))
 S ATC=$G(PSDAT(F,IENS,7.2,"E"))
 S TMATM=$G(PSDAT(F,IENS,7.4,"I"))
 S RM=$G(PSDAT(F,IENS,7.5,"E"))
 S RUMT=$G(PSDAT(F,IENS,7.6,"E"))
 S RUMCQ=$G(PSDAT(F,IENS,7.8,"I"))
 S RUMC=$G(PSDAT(F,IENS,7.7,"E"))
 S TPBT=$$SYMENC^MXMLUTL($G(PSDAT(F,IENS,8.1,"E")))
 S TPBCQ=$G(PSDAT(F,IENS,8.3,"I"))
 S TPBC=$G(PSDAT(F,IENS,8.2,"E"))
 S FNV=$G(PSDAT(F,IENS,8.4,"E"))
 S FUT=$$SYMENC^MXMLUTL($G(PSDAT(F,IENS,8.5,"E")))
 S FUCQ=$G(PSDAT(F,IENS,8.7,"I"))
 S FUC=$G(PSDAT(F,IENS,8.6,"E"))
 S VFM=$G(PSDAT(F,IENS,8.8,"I"))
 S INV=$G(PSDAT(F,IENS,9.1,"E"))
 S IUT=$$SYMENC^MXMLUTL($G(PSDAT(F,IENS,9.2,"E")))
 S IUCQ=$G(PSDAT(F,IENS,9.4,"I"))
 S IUC=$G(PSDAT(F,IENS,9.3,"E"))
 S VIM=$G(PSDAT(F,IENS,9.5,"I"))
 S DNV=$G(PSDAT(F,IENS,9.6,"E"))
 S DT=$G(PSDAT(F,IENS,9.7,"E"))
 S DTCQ=$G(PSDAT(F,IENS,9.9,"I"))
 S DTC=$G(PSDAT(F,IENS,9.8,"E"))
 S MDRNV=$G(PSDAT(F,IENS,10.1,"E"))
 S MDRUT=$$SYMENC^MXMLUTL($G(PSDAT(F,IENS,10.2,"E")))
 S MDRCQ=$G(PSDAT(F,IENS,10.3,"I"))
 S MDRUC=$G(PSDAT(F,IENS,10.4,"E"))
 S MDRVN=$G(PSDAT(F,IENS,10.5,"E"))
 S MDRVUT=$$SYMENC^MXMLUTL($G(PSDAT(F,IENS,10.6,"E")))
 S MDRVUCQ=$G(PSDAT(F,IENS,10.8,"I"))
 S MDRVUC=$G(PSDAT(F,IENS,10.7,"E"))
 S MDRVDM=$G(PSDAT(F,IENS,10.9,"I"))
 S IPT=$$SYMENC^MXMLUTL($G(PSDAT(F,IENS,11.1,"E")))
 S IPCQ=$G(PSDAT(F,IENS,11.3,"I"))
 S IPC=$G(PSDAT(F,IENS,11.2,"E"))
 S IT=$$SYMENC^MXMLUTL($G(PSDAT(F,IENS,11.4,"E")))
 S ITCQ=$G(PSDAT(F,IENS,11.6,"I"))
 S ITC=$G(PSDAT(F,IENS,11.5,"E"))
 S IVT=$$SYMENC^MXMLUTL($G(PSDAT(F,IENS,12.1,"E")))
 S IVU=$G(PSDAT(F,IENS,12.2,"E"))
 S IVUMT=$$SYMENC^MXMLUTL($G(PSDAT(F,IENS,12.3,"E")))
 S IVUMCQ=$G(PSDAT(F,IENS,12.5,"I"))
 S IVUMC=$$SYMENC^MXMLUTL($G(PSDAT(F,IENS,12.4,"E")))
 S IVM=$G(PSDAT(F,IENS,12.6,"I"))
 S STOPI=$G(PSDAT(F,IENS,12.7,"I"))
 D C S @GBL@(CNT,0)="<StructuredSIG>"
 D C S @GBL@(CNT,0)="<RepeatingSIG>"
 D C S @GBL@(CNT,0)="<SigSequencePositionNumber>"_SSPN_"</SigSequencePositionNumber>"
 D C S @GBL@(CNT,0)="<MultipleSigModifier>"_MSM_"</MultipleSigModifier>"
 D C S @GBL@(CNT,0)="</RepeatingSIG>"
 D C S @GBL@(CNT,0)="<CodeSystem>"
 D C S @GBL@(CNT,0)="<SNOMEDVersion>"_SV_"</SNOMEDVersion>"
 D C S @GBL@(CNT,0)="<FMTVersion>"_FMTV_"</FMTVersion>"
 D C S @GBL@(CNT,0)="</CodeSystem>"
 D C S @GBL@(CNT,0)="<FreeText>"
 D C S @GBL@(CNT,0)="<SigFreeTextStringIndicator>"_SFTSI_"</SigFreeTextStringIndicator>"
 D C S @GBL@(CNT,0)="<SigFreeText>"_SFT_"</SigFreeText>"
 D C S @GBL@(CNT,0)="</FreeText>"
 D C S @GBL@(CNT,0)="<Dose>"
 D C S @GBL@(CNT,0)="<DoseCompositeIndicator>"_DCI_"</DoseCompositeIndicator>"
 D C S @GBL@(CNT,0)="<DoseDeliveryMethodText>"_DDM_"</DoseDeliveryMethodText>"
 I $L(DDMCQ) D C S @GBL@(CNT,0)="<DoseDeliveryMethodCodeQualifier>"_DDMCQ_"</DoseDeliveryMethodCodeQualifier>"
 D C S @GBL@(CNT,0)="<DoseDeliveryMethodCode>"_DDMC_"</DoseDeliveryMethodCode>"
 D C S @GBL@(CNT,0)="<DoseDeliveryMethodModifierText>"_DDMMT_"</DoseDeliveryMethodModifierText>"
 I $L(DDMMCQ) D C S @GBL@(CNT,0)="<DoseDeliveryMethodModifierCodeQualifier>"_DDMMCQ_"</DoseDeliveryMethodModifierCodeQualifier>"
 D C S @GBL@(CNT,0)="<DoseDeliveryMethodModifierCode>"_DDMMC_"</DoseDeliveryMethodModifierCode>"
 D C S @GBL@(CNT,0)="<DoseQuantity>"_DQ_"</DoseQuantity>"
 D C S @GBL@(CNT,0)="<DoseFormText>"_DFT_"</DoseFormText>"
 I $L(DFCQ) D C S @GBL@(CNT,0)="<DoseFormCodeQualifier>"_DFCQ_"</DoseFormCodeQualifier>"
 D C S @GBL@(CNT,0)="<DoseFormCode>"_DFC_"</DoseFormCode>"
 I $L(DRM) D C S @GBL@(CNT,0)="<DoseRangeModifier>"_DRM_"</DoseRangeModifier>"
 D C S @GBL@(CNT,0)="</Dose>"
 D C S @GBL@(CNT,0)="<DoseCalculation>"
 D C S @GBL@(CNT,0)="<DosingBasisNumericValue>"_DBMV_"</DosingBasisNumericValue>"
 D C S @GBL@(CNT,0)="<DosingBasisUnitofMeasureText>"_DBUM_"</DosingBasisUnitofMeasureText>"
 I $L(DBUMCQ) D C S @GBL@(CNT,0)="<DosingBasisUnitofMeasureCodeQualifier>"_DBUMCQ_"</DosingBasisUnitofMeasureCodeQualifier>"
 D C S @GBL@(CNT,0)="<DosingBasisUnitofMeasureCode>"_DBUC_"</DosingBasisUnitofMeasureCode>"
 I $L(BMQ) D C S @GBL@(CNT,0)="<BodyMetricQualifier>"_BMQ_"</BodyMetricQualifier>"
 D C S @GBL@(CNT,0)="<BodyMetricValue>"_BMV_"</BodyMetricValue>"
 D C S @GBL@(CNT,0)="<CalculatedDoseNumeric>"_CDM_"</CalculatedDoseNumeric>"
 D C S @GBL@(CNT,0)="<CalculatedDoseUnitofMeasureText>"_CDUMT_"</CalculatedDoseUnitofMeasureText>"
 I $L(CDUMCQ) D C S @GBL@(CNT,0)="<CalculatedDoseUnitofMeasureCodeQualifier>"_CDUMCQ_"</CalculatedDoseUnitofMeasureCodeQualifier>"
 D C S @GBL@(CNT,0)="<CalculatedDoseUnitofMeasureCode>"_CDUMC_"</CalculatedDoseUnitofMeasureCode>"
 D C S @GBL@(CNT,0)="<DosingBasisRangeModifier>"_DBRM_"</DosingBasisRangeModifier>"
 D C S @GBL@(CNT,0)="</DoseCalculation>"
 D C S @GBL@(CNT,0)="<Vehicle>"
 D C S @GBL@(CNT,0)="<VehicleName>"_VN_"</VehicleName>"
 I $L(VNCQ) D C S @GBL@(CNT,0)="<VehicleNameCodeQualifier>"_VNCQ_"</VehicleNameCodeQualifier>"
 D C S @GBL@(CNT,0)="<VehicleNameCode>"_VNC_"</VehicleNameCode>"
 D C S @GBL@(CNT,0)="<VehicleQuantity>"_VQ_"</VehicleQuantity>"
 D C S @GBL@(CNT,0)="<VehicleUnitOfMeasureText>"_VUMT_"</VehicleUnitOfMeasureText>"
 I $L(VUMCQ) D C S @GBL@(CNT,0)="<VehicleUnitOfMeasureCodeQualifier>"_VUMCQ_"</VehicleUnitOfMeasureCodeQualifier>"
 D C S @GBL@(CNT,0)="<VehicleUnitOfMeasureCode>"_VUMC_"</VehicleUnitOfMeasureCode>"
 D C S @GBL@(CNT,0)="<MultipleVehicleModifier>"_MVM_"</MultipleVehicleModifier>"
 D C S @GBL@(CNT,0)="</Vehicle>"
 D C S @GBL@(CNT,0)="<RouteofAdministration>"
 D C S @GBL@(CNT,0)="<RouteofAdministrationText>"_RAT_"</RouteofAdministrationText>"
 I $L(RACQ) D C S @GBL@(CNT,0)="<RouteofAdministrationCodeQualifier>"_RACQ_"</RouteofAdministrationCodeQualifier>"
 D C S @GBL@(CNT,0)="<RouteofAdministrationCode>"_RAC_"</RouteofAdministrationCode>"
 I $L(MRAM) D C S @GBL@(CNT,0)="<MultipleRouteofAdministrationModifier>"_MRAM_"</MultipleRouteofAdministrationModifier>"
 D C S @GBL@(CNT,0)="</RouteofAdministration>"
 D C S @GBL@(CNT,0)="<SiteofAdministration>"
 D C S @GBL@(CNT,0)="<SiteofAdministrationText>"_SAT_"</SiteofAdministrationText>"
 I $L(SACQ) D C S @GBL@(CNT,0)="<SiteofAdministrationCodeQualifier>"_SACQ_"</SiteofAdministrationCodeQualifier>"
 D C S @GBL@(CNT,0)="<SiteofAdministrationCode>"_SAC_"</SiteofAdministrationCode>"
 I $L(MATM) D C S @GBL@(CNT,0)="<MultipleAdministrationTimingModifier>"_MATM_"</MultipleAdministrationTimingModifier>"
 D C S @GBL@(CNT,0)="</SiteofAdministration>"
 D C S @GBL@(CNT,0)="<Timing>"
 D C S @GBL@(CNT,0)="<AdministrationTimingText>"_ATT_"</AdministrationTimingText>"
 I $L(ATCQ) D C S @GBL@(CNT,0)="<AdministrationTimingCodeQualifier>"_ATCQ_"</AdministrationTimingCodeQualifier>"
 D C S @GBL@(CNT,0)="<AdministrationTimingCode>"_ATC_"</AdministrationTimingCode>"
 I $L(TMATM) D C S @GBL@(CNT,0)="<MultipleAdministrationTimingModifier>"_TMATM_"</MultipleAdministrationTimingModifier>"
 D C S @GBL@(CNT,0)="<RateofAdministration>"_RM_"</RateofAdministration>"
 D C S @GBL@(CNT,0)="<RateUnitofMeasureText>"_RUMT_"</RateUnitofMeasureText>"
 I $L(RUMCQ) D C S @GBL@(CNT,0)="<RateUnitofMeasureCodeQualifier>"_RUMCQ_"</RateUnitofMeasureCodeQualifier>"
 D C S @GBL@(CNT,0)="<RateUnitofMeasureCode>"_RUMC_"</RateUnitofMeasureCode>"
 D C S @GBL@(CNT,0)="<TimePeriodBasisText>"_TPBT_"</TimePeriodBasisText>"
 I $L(TPBCQ) D C S @GBL@(CNT,0)="<TimePeriodBasisCodeQualifier>"_TPBCQ_"</TimePeriodBasisCodeQualifier>"
 D C S @GBL@(CNT,0)="<TimePeriodBasisCode>"_TPBC_"</TimePeriodBasisCode>"
 D C S @GBL@(CNT,0)="<FrequencyNumericValue>"_FNV_"</FrequencyNumericValue>"
 D C S @GBL@(CNT,0)="<FrequencyUnitsText>"_FUT_"</FrequencyUnitsText>"
 I $L(FUCQ) D C S @GBL@(CNT,0)="<FrequencyUnitsCodeQualifier>"_FUCQ_"</FrequencyUnitsCodeQualifier>"
 D C S @GBL@(CNT,0)="<FrequencyUnitsCode>"_FUC_"</FrequencyUnitsCode>"
 I $L(VFM) D C S @GBL@(CNT,0)="<VariableFrequencyModifier>"_VFM_"</VariableFrequencyModifier>"
 D C S @GBL@(CNT,0)="<IntervalNumericValue>"_INV_"</IntervalNumericValue>"
 D C S @GBL@(CNT,0)="<IntervalUnitsText>"_IUT_"</IntervalUnitsText>"
 I $L(IUCQ) D C S @GBL@(CNT,0)="<IntervalUnitsCodeQualifier>"_IUCQ_"</IntervalUnitsCodeQualifier>"
 D C S @GBL@(CNT,0)="<IntervalUnitsCode>"_IUC_"</IntervalUnitsCode>"
 I $L(VIM) D C S @GBL@(CNT,0)="<VariableIntervalModifier>"_VIM_"</VariableIntervalModifier>"
 D C S @GBL@(CNT,0)="</Timing>"
 D C S @GBL@(CNT,0)="<Duration>"
 D C S @GBL@(CNT,0)="<DurationNumericValue>"_DNV_"</DurationNumericValue>"
 D C S @GBL@(CNT,0)="<DurationText>"_DT_"</DurationText>"
 I $L(DTCQ) D C S @GBL@(CNT,0)="<DurationTextCodeQualifier>"_DTCQ_"</DurationTextCodeQualifier>"
 D C S @GBL@(CNT,0)="<DurationTextCode>"_DTC_"</DurationTextCode>"
 D C S @GBL@(CNT,0)="</Duration>"
 D C S @GBL@(CNT,0)="<MaximumDoseRestriction>"
 D C S @GBL@(CNT,0)="<MaximumDoseRestrictionNumericValue>"_MDRNV_"</MaximumDoseRestrictionNumericValue>"
 D C S @GBL@(CNT,0)="<MaximumDoseRestrictionUnitsText>"_MDRUT_"</MaximumDoseRestrictionUnitsText>"
 I $L(MDRCQ) D C S @GBL@(CNT,0)="<MaximumDoseRestrictionCodeQualifier>"_MDRCQ_"</MaximumDoseRestrictionCodeQualifier>"
 D C S @GBL@(CNT,0)="<MaximumDoseRestrictionUnitsCode>"_MDRUC_"</MaximumDoseRestrictionUnitsCode>"
 D C S @GBL@(CNT,0)="<MaximumDoseRestrictionVariableNumericValue>"_MDRVN_"</MaximumDoseRestrictionVariableNumericValue>"
 D C S @GBL@(CNT,0)="<MaximumDoseRestrictionVariableUnitsText>"_MDRVUT_"</MaximumDoseRestrictionVariableUnitsText>"
 I $L(MDRVUCQ) D C S @GBL@(CNT,0)="<MaximumDoseRestrictionVariableUnitsCodeQualifier>"_MDRVUCQ_"</MaximumDoseRestrictionVariableUnitsCodeQualifier>"
 D C S @GBL@(CNT,0)="<MaximumDoseRestrictionVariableUnitsCode>"_MDRVUC_"</MaximumDoseRestrictionVariableUnitsCode>"
 I $L(MDRVDM) D C S @GBL@(CNT,0)="<MaximumDoseRestrictionVariableDurationModifier>"_MDRVDM_"</MaximumDoseRestrictionVariableDurationModifier>"
 D C S @GBL@(CNT,0)="</MaximumDoseRestriction>"
 D C S @GBL@(CNT,0)="<Indication>"
 D C S @GBL@(CNT,0)="<IndicationPrecursorText>"_IPT_"</IndicationPrecursorText>"
 I $L(IPCQ) D C S @GBL@(CNT,0)="<IndicationPrecursorCodeQualifier>"_IPCQ_"</IndicationPrecursorCodeQualifier>"
 D C S @GBL@(CNT,0)="<IndicationPrecursorCode>"_IPC_"</IndicationPrecursorCode>"
 D C S @GBL@(CNT,0)="<IndicationText>"_IT_"</IndicationText>"
 I $L(ITCQ) D C S @GBL@(CNT,0)="<IndicationTextCodeQualifier>"_ITCQ_"</IndicationTextCodeQualifier>"
 D C S @GBL@(CNT,0)="<IndicationTextCode>"_ITC_"</IndicationTextCode>"
 D C S @GBL@(CNT,0)="<IndicationValueText>"_IVT_"</IndicationValueText>"
 D C S @GBL@(CNT,0)="<IndicationValueUnit>"_IVU_"</IndicationValueUnit>"
 D C S @GBL@(CNT,0)="<IndicationValueUnitofMeasureText>"_IVUMT_"</IndicationValueUnitofMeasureText>"
 I $L(IVUMCQ) D C S @GBL@(CNT,0)="<IndicationValueUnitofMeasureCodeQualifier>"_IVUMCQ_"</IndicationValueUnitofMeasureCodeQualifier>"
 D C S @GBL@(CNT,0)="<IndicationValueUnitofMeasureCode>"_IVUMC_"</IndicationValueUnitofMeasureCode>"
 I $L(IVM) D C S @GBL@(CNT,0)="<IndicationVariableModifier>"_IVM_"</IndicationVariableModifier>"
 D C S @GBL@(CNT,0)="</Indication>"
 I $L(STOPI) D
 .D C S @GBL@(CNT,0)="<Stop>"
 .D C S @GBL@(CNT,0)="<StopIndicator>"_STOPI_"</StopIndicator>"
 .D C S @GBL@(CNT,0)="</Stop>"
 D C S @GBL@(CNT,0)="</StructuredSIG>"
 Q
C ;
 S CNT=$G(CNT)+1
 Q
